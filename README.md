
# Racing Data Analysis with Deep Learning

![](data/frames/frame_02_20880.jpg)

This project contains a suite of scripts designed to create, train, and evaluate a deep learning model for racing data analysis.

The model attempts to predict multiple outputs from input frames:

- Whether the car is in a race (`in_race`)
- The car's speed (`speed`)
- The car's position in the race (`position`)
- The current lap (`lap`)
- The current gear (`gear`)

## Files

- `data.py`: Contains the RacingDataset class, a custom PyTorch dataset class, and a function to create data loaders.
- `model.py`: Defines RacingNet, a PyTorch model for predicting multiple outputs.
- `train.py`: Contains functions for training and evaluation per epoch, and a main function to handle the training loop.
- `eval.py`: Contains functions for calculating speed error and accuracy, and a main function for evaluating the model.
- `model_weights.pth`: Trained weights for the RacingNet model. (This file is not included in the repository and needs to be generated by running the `train.py` script)

## Setup and Usage

1. Install the required Python packages if you haven't done so already:
    ```
    pip install torch torchvision pandas numpy pillow
    ```

2. Run the `train.py` script to train the model:
    ```
    python train.py
    ```

3. Run the `eval.py` script to evaluate the model:
    ```
    python eval.py
    ```

Please note: This project assumes you have a CSV dataset located at `data/dataset.csv` and image frames in the corresponding directory. Update these paths in `data.py` if necessary.

## Outputs

The model outputs the following predictions for each frame:

- `in_race`: A binary value indicating whether the car is in a race.
- `speed`: A continuous value representing the car's speed, normalized to [0, 1] where 1 is the maximum speed of 500 mph.
- `position`: A categorical value indicating the car's position in the race, from 1 to the number of cars in the race.
- `lap`: A categorical value indicating the current lap, from 1 to the total number of laps.
- `gear`: A categorical value indicating the current gear, including 'N' and 'R'.
